---
import Layout from '../../layouts/Layout.astro';
 
if (Astro.request.method === "POST") {
  try {
    const data = await Astro.request.formData();
    const password = data.get("password");
    
    // HARDCODED PASSWORD FOR DEMO PURPOSES
    if (password === "admin123") {
      Astro.cookies.set("auth_token", "valid_session", { 
        path: "/",
        httpOnly: true,
        secure: import.meta.env.PROD,
        maxAge: 60 * 60 * 24 * 7 // 1 week
      });
      return Astro.redirect("/admin");
    }
  } catch (error) {
    console.error(error);
  }
}
---

<Layout title="Login Admin">
  <main class="login-container">
    <div class="login-box">
      <h1>Meralis Admin</h1>
      <form method="POST">
        <label>
          Senha de Acesso:
          <input type="password" name="password" required />
        </label>
        <button type="submit">Entrar</button>
      </form>
    </div>
  </main>
</Layout>

<style>
  .login-container {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background: #f0f0f0;
    color: #333;
    font-family: sans-serif;
  }
  .login-box {
    background: white;
    padding: 2rem;
    border: 1px solid #ccc;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  }
  h1 { margin-top: 0; font-size: 1.5rem; text-transform: uppercase; }
  label { display: block; margin-bottom: 1rem; }
  input { display: block; width: 100%; padding: 0.5rem; margin-top: 0.5rem; border: 1px solid #999; }
  button { 
    background: black; 
    color: white; 
    border: none; 
    padding: 0.5rem 1rem; 
    cursor: pointer; 
    text-transform: uppercase; 
    font-weight: bold;
    width: 100%;
  }
  button:hover { background: #333; }
</style>
